<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEXUS | Orders Management</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Outfit:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <script src="https://unpkg.com/feather-icons"></script>
    <style>
        :root {
            /* Core Palette - Light Mode (Default) */
            --bg-dark: #f8fafc;
            /* Slate 50 */
            --bg-panel: rgba(255, 255, 255, 0.7);
            --bg-card: rgba(255, 255, 255, 0.5);

            /* Accents */
            --primary: #06b6d4;
            /* Cyan 500 */
            --primary-glow: rgba(6, 182, 212, 0.2);
            --secondary: #8b5cf6;
            /* Violet 500 */
            --accent: #f43f5e;
            /* Rose 500 */

            /* Text */
            --text-main: #0f172a;
            /* Slate 900 */
            --text-muted: #64748b;
            /* Slate 500 */
            --text-dim: #94a3b8;
            /* Slate 400 */

            /* Borders */
            --border-light: rgba(0, 0, 0, 0.05);
            --border-glow: rgba(6, 182, 212, 0.3);

            /* Spacing */
            --sidebar-width: 280px;
            --sidebar-width-collapsed: 80px;
            --header-height: 80px;
        }

        /* Dark Mode Overrides */
        body.dark-mode {
            --bg-dark: #030712;
            --bg-panel: rgba(17, 24, 39, 0.7);
            --bg-card: rgba(31, 41, 55, 0.4);

            --primary-glow: rgba(6, 182, 212, 0.5);

            --text-main: #f8fafc;
            --text-muted: #94a3b8;
            --text-dim: #475569;

            --border-light: rgba(255, 255, 255, 0.05);
        }

        /* Adjust gradients for dark mode */
        body.dark-mode {
            background-image:
                radial-gradient(circle at 10% 20%, rgba(6, 182, 212, 0.1) 0%, transparent 40%),
                radial-gradient(circle at 90% 80%, rgba(139, 92, 246, 0.1) 0%, transparent 40%);
        }

        /* Adjust glass effects for dark mode */
        body.dark-mode .glass {
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1);
        }

        body.dark-mode .glass-card {
            box-shadow: none;
        }

        body.dark-mode .glass-card:hover {
            box-shadow: 0 0 20px rgba(6, 182, 212, 0.15);
        }

        /* Adjust logo text for dark mode */
        body.dark-mode .logo-text {
            background: linear-gradient(to right, #fff, #94a3b8);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        /* Adjust hover states for dark mode */
        body.dark-mode .nav-item:hover {
            color: #fff;
            background: rgba(255, 255, 255, 0.03);
        }

        body.dark-mode .search-bar input {
            background: rgba(255, 255, 255, 0.03);
            color: #fff;
        }

        body.dark-mode .search-bar input:focus {
            background: rgba(6, 182, 212, 0.05);
        }

        body.dark-mode .icon-btn {
            background: rgba(255, 255, 255, 0.03);
        }

        body.dark-mode .icon-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        body.dark-mode .user-profile {
            background: rgba(255, 255, 255, 0.03);
        }

        body.dark-mode .avatar {
            background: linear-gradient(45deg, #333, #555);
            border-color: var(--primary);
        }

        body.dark-mode .avatar::after {
            border-color: var(--bg-dark);
        }

        body.dark-mode .profile-dropdown {
            background: rgba(17, 24, 39, 0.9);
            border-color: var(--border-light);
        }

        body.dark-mode .profile-menu-item {
            color: var(--text-muted);
        }

        body.dark-mode .profile-menu-item:hover {
            background: rgba(255, 255, 255, 0.05);
            color: #fff;
        }

        body.dark-mode .profile-menu-item.logout {
            border-top-color: var(--border-light);
        }

        body.dark-mode .profile-menu-item.logout:hover {
            background: rgba(244, 63, 94, 0.15);
        }

        body.dark-mode .stat-value {
            color: #fff;
        }

        body.dark-mode tr:hover td {
            background: rgba(255, 255, 255, 0.02);
        }

        body.dark-mode .chart-title {
            color: #fff;
        }

        body.dark-mode .page-title h1 {
            background: linear-gradient(to right, #fff, #cbd5e1);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            scrollbar-width: thin;
            scrollbar-color: var(--primary) var(--bg-dark);
        }

        /* Smooth theme transitions with performance optimization */
        body {
            transition: background-color 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        body *,
        .glass,
        .glass-card,
        .sidebar,
        .main-content,
        .header,
        .icon-btn,
        .nav-item,
        .search-bar input,
        .user-profile,
        .table-container,
        .status-badge,
        .doc-badge,
        .custom-tooltip,
        .bulk-dropdown,
        .page-btn,
        .action-btn {
            transition: background-color 0.2s ease,
                        border-color 0.2s ease,
                        color 0.2s ease,
                        box-shadow 0.2s ease;
        }

        /* Optimize theme switch performance */
        body.transitioning * {
            will-change: background-color, color, border-color;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-dark);
            background-image:
                radial-gradient(circle at 10% 20%, rgba(6, 182, 212, 0.05) 0%, transparent 40%),
                radial-gradient(circle at 90% 80%, rgba(139, 92, 246, 0.05) 0%, transparent 40%);
            color: var(--text-main);
            height: 100vh;
            overflow: hidden;
            display: flex;
        }

        /* Typography */
        h1,
        h2,
        h3,
        h4,
        h5,
        h6 {
            font-family: 'Outfit', sans-serif;
            letter-spacing: -0.02em;
        }

        /* Glassmorphism Utilities */
        .glass {
            background: var(--bg-panel);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--border-light);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.03);
        }

        .glass-card {
            background: var(--bg-card);
            backdrop-filter: blur(12px);
            border: 1px solid var(--border-light);
            border-radius: 16px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.02), 0 2px 4px -1px rgba(0, 0, 0, 0.02);
        }

        .glass-card:hover {
            border-color: var(--border-glow);
            box-shadow: 0 10px 25px -5px rgba(6, 182, 212, 0.15), 0 8px 10px -6px rgba(6, 182, 212, 0.1);
            transform: translateY(-2px);
        }

        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            height: 100%;
            display: flex;
            flex-direction: column;
            padding: 2rem;
            border-right: 1px solid var(--border-light);
            z-index: 50;
            transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .sidebar.collapsed {
            width: var(--sidebar-width-collapsed);
            padding: 2rem 1rem;
        }

        /* Logo Container */
        .logo-container {
            margin-bottom: 2rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
            position: relative;
        }

        .app-brand {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding-left: 0.5rem;
        }

        .logo-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px var(--primary-glow);
            color: white;
            flex-shrink: 0;
        }

        .logo-text {
            font-size: 1.25rem;
            font-weight: 700;
            background: linear-gradient(to right, #0f172a, #475569);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .sidebar.collapsed .logo-text,
        .sidebar.collapsed .nav-item span,
        .sidebar.collapsed .user-info,
        .sidebar.collapsed .user-profile i {
            display: none;
            opacity: 0;
        }

        .sidebar.collapsed .logo-container {
            justify-content: center;
        }

        .sidebar.collapsed .nav-item {
            justify-content: center;
            padding: 1rem;
        }

        .sidebar.collapsed .user-profile {
            justify-content: center;
            padding: 0.75rem;
        }

        /* Navigation Menu */
        .nav-menu {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
            flex: 1;
        }

        .nav-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem 1.25rem;
            border-radius: 12px;
            color: var(--text-muted);
            text-decoration: none;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            cursor: pointer;
        }

        .nav-item:hover {
            color: var(--primary);
            background: rgba(0, 0, 0, 0.03);
        }

        .nav-item.active {
            color: var(--primary);
            background: rgba(6, 182, 212, 0.1);
            border: 1px solid rgba(6, 182, 212, 0.2);
        }

        .nav-item.active::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 3px;
            background: var(--primary);
            box-shadow: 0 0 10px var(--primary);
        }

        .user-profile {
            margin-top: auto;
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.5);
            border-radius: 16px;
            border: 1px solid var(--border-light);
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
        }

        .user-profile:hover {
            background: rgba(255, 255, 255, 0.8);
            border-color: var(--border-glow);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(45deg, #cbd5e1, #94a3b8);
            border: 2px solid var(--primary);
            position: relative;
        }

        .avatar::after {
            content: '';
            position: absolute;
            bottom: 0;
            right: 0;
            width: 10px;
            height: 10px;
            background: #10b981;
            border-radius: 50%;
            border: 2px solid #fff;
        }

        .user-info h4 {
            font-size: 0.9rem;
            color: var(--text-main);
        }

        .user-info p {
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .profile-dropdown {
            position: absolute;
            bottom: 100%;
            left: 0;
            width: 100%;
            margin-bottom: 0.75rem;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--border-light);
            border-radius: 16px;
            padding: 0.5rem;
            display: none;
            flex-direction: column;
            gap: 0.25rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
            z-index: 100;
            opacity: 0;
            transform: translateY(10px) scale(0.98);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .profile-dropdown.show {
            display: flex;
            opacity: 1;
            transform: translateY(0) scale(1);
        }

        .profile-menu-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            border-radius: 10px;
            color: var(--text-main);
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
        }

        .profile-menu-item:hover {
            background: rgba(0, 0, 0, 0.05);
            color: var(--primary);
        }

        .profile-menu-item.logout {
            color: var(--accent);
            border-top: 1px solid var(--border-light);
            margin-top: 0.25rem;
            padding-top: 0.75rem;
            border-radius: 0 0 10px 10px;
        }

        .profile-menu-item.logout:hover {
            background: rgba(244, 63, 94, 0.1);
        }

        .profile-menu-item svg {
            width: 16px;
            height: 16px;
        }

        /* Sidebar Toggle Button */
        .sidebar-toggle {
            position: absolute;
            top: 50%;
            right: -12px;
            transform: translateY(-50%);
            width: 24px;
            height: 24px;
            background: var(--bg-dark);
            border: 1px solid var(--border-light);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: var(--text-muted);
            z-index: 60;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .logo-container {
            margin-bottom: 2rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .app-brand {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding-left: 0.5rem;
        }

        .logo-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px var(--primary-glow);
            color: white;
            flex-shrink: 0;
        }

        .logo-text {
            font-size: 1.25rem;
            font-weight: 700;
            background: linear-gradient(to right, var(--text-main), var(--text-muted));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .workspace-selector {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--border-light);
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            width: 100%;
            position: relative;
            overflow: hidden;
        }

        .workspace-selector::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.1), transparent);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .workspace-selector:hover {
            background: rgba(255, 255, 255, 0.25);
            border-color: var(--border-glow);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .workspace-selector:hover::before {
            opacity: 1;
        }

        .workspace-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 1rem;
            box-shadow: 0 2px 8px var(--primary-glow);
            position: relative;
            z-index: 1;
        }

        .workspace-info {
            flex: 1;
            overflow: hidden;
            position: relative;
            z-index: 1;
        }

        .workspace-name {
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--text-main);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .workspace-role {
            font-size: 0.75rem;
            color: var(--text-muted);
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .selector-chevron {
            color: var(--text-muted);
            transition: transform 0.3s ease;
        }

        .workspace-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            width: 100%;
            margin-top: 0.5rem;
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--border-light);
            border-radius: 16px;
            padding: 0.5rem;
            display: none;
            flex-direction: column;
            gap: 0.25rem;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            z-index: 100;
            opacity: 0;
            transform: translateY(-10px) scale(0.98);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .workspace-dropdown.show {
            display: flex;
            opacity: 1;
            transform: translateY(0) scale(1);
        }

        .workspace-search {
            padding: 0.5rem;
            margin-bottom: 0.25rem;
            position: relative;
        }

        .workspace-search input {
            width: 100%;
            padding: 0.5rem 0.75rem 0.5rem 2rem;
            background: rgba(0, 0, 0, 0.05);
            border: 1px solid transparent;
            border-radius: 8px;
            color: var(--text-main);
            font-size: 0.85rem;
            transition: all 0.2s ease;
        }

        .workspace-search input:focus {
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--primary);
            outline: none;
        }

        .workspace-search svg {
            position: absolute;
            left: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-muted);
            width: 14px;
            height: 14px;
        }

        .workspace-list {
            max-height: 200px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .workspace-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 1px solid transparent;
        }

        .workspace-item:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(255, 255, 255, 0.05);
        }

        .workspace-item.active {
            background: rgba(6, 182, 212, 0.08);
            border-color: rgba(6, 182, 212, 0.2);
        }

        .workspace-item .item-icon {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            background: #e2e8f0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            color: #475569;
            font-size: 1rem;
        }

        .workspace-item.active .item-icon {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            box-shadow: 0 2px 8px var(--primary-glow);
        }

        .workspace-actions {
            margin-top: 0.5rem;
            padding-top: 0.5rem;
            border-top: 1px solid var(--border-light);
        }

        .create-workspace-btn {
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.6rem;
            border-radius: 8px;
            background: transparent;
            border: 1px dashed var(--border-light);
            color: var(--text-muted);
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .create-workspace-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
            background: rgba(6, 182, 212, 0.05);
        }

        .dropdown-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: var(--text-main);
            text-decoration: none;
        }

        .dropdown-item:hover {
            background: rgba(0, 0, 0, 0.05);
        }

        .dropdown-item.active {
            background: rgba(6, 182, 212, 0.1);
        }

        .dropdown-icon {
            width: 32px;
            height: 32px;
            background: rgba(0, 0, 0, 0.1);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-muted);
            font-size: 0.875rem;
            font-weight: 600;
        }

        body.dark-mode .dropdown-item:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        body.dark-mode .dropdown-icon {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-main);
        }

        /* Main Content */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }

        /* Header */
        .header {
            height: var(--header-height);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 2rem;
            border-bottom: 1px solid var(--border-light);
        }

        .search-bar {
            position: relative;
            width: 400px;
        }

        .search-bar input {
            width: 100%;
            background: rgba(0, 0, 0, 0.03);
            border: 1px solid var(--border-light);
            padding: 0.75rem 1rem 0.75rem 3rem;
            border-radius: 12px;
            color: var(--text-main);
            font-family: 'Inter', sans-serif;
            transition: all 0.3s ease;
        }

        .search-bar input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 15px rgba(6, 182, 212, 0.1);
            background: #fff;
        }

        .search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-muted);
            width: 18px;
            height: 18px;
        }

        .header-actions {
            display: flex;
            gap: 1rem;
        }

        .icon-btn {
            width: 40px;
            height: 40px;
            border-radius: 12px;
            background: rgba(0, 0, 0, 0.03);
            border: 1px solid var(--border-light);
            color: var(--text-main);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .icon-btn:hover {
            background: rgba(0, 0, 0, 0.05);
            color: var(--primary);
        }

        .notification-dot {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 8px;
            height: 8px;
            background: var(--accent);
            border-radius: 50%;
            box-shadow: 0 0 5px var(--accent);
        }

        /* Dashboard Content */
        .dashboard-container {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 2rem;
        }

        .page-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            margin-bottom: 1rem;
        }

        .page-title h1 {
            font-size: 2rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
            background: linear-gradient(to right, #0f172a, #64748b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .page-title p {
            color: var(--text-muted);
        }

        .action-btn {
            padding: 0.75rem 1.5rem;
            background: linear-gradient(135deg, var(--primary), #0891b2);
            border: none;
            border-radius: 12px;
            color: #fff;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: 0 4px 15px rgba(6, 182, 212, 0.3);
            transition: all 0.3s ease;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(6, 182, 212, 0.4);
        }

        /* Recent Orders Table */
        .table-container {
            padding: 0;
            flex: 1;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            max-height: calc(100vh - 200px);
            /* Fit within viewport */
        }

        .table-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border-light);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
            /* Don't shrink the header */
        }

        .table-wrapper {
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
            padding: 0 1.5rem;
            /* Table scrolls, but pagination stays fixed at bottom */
        }

        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            table-layout: fixed;
            /* Fixed layout prevents resize on content change */
        }

        /* Smooth table updates - exclude from theme transitions */
        #ordersTableBody {
            transition: opacity 0.15s ease !important;
        }

        /* Exclude feather icons from theme transitions to prevent lag */
        svg,
        svg * {
            transition: none !important;
        }

        /* Payment Method Badges */
        .payment-badge {
            width: 22px;
            height: 22px;
            border-radius: 4px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-left: 0.5rem;
            border: 1.5px solid;
            flex-shrink: 0;
            cursor: help;
            transition: all 0.2s ease;
            position: relative;
        }

        .payment-badge svg {
            width: 12px;
            height: 12px;
        }

        /* Tooltip on hover */
        .payment-badge::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%) translateY(-4px);
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 0.375rem 0.75rem;
            border-radius: 6px;
            font-size: 0.75rem;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s ease, transform 0.2s ease;
            z-index: 1000;
        }

        .payment-badge:hover::after {
            opacity: 1;
            transform: translateX(-50%) translateY(-8px);
        }

        body.dark-mode .payment-badge::after {
            background: rgba(255, 255, 255, 0.95);
            color: #0f172a;
        }

        .payment-badge-cod {
            background: rgba(245, 158, 11, 0.15);
            color: #f59e0b;
            border-color: rgba(245, 158, 11, 0.3);
        }

        .payment-badge-cod:hover {
            background: rgba(245, 158, 11, 0.25);
            border-color: rgba(245, 158, 11, 0.5);
            transform: scale(1.08);
            box-shadow: 0 3px 8px rgba(245, 158, 11, 0.3);
        }

        .payment-badge-card {
            background: rgba(16, 185, 129, 0.15);
            color: #10b981;
            border-color: rgba(16, 185, 129, 0.3);
        }

        .payment-badge-card:hover {
            background: rgba(16, 185, 129, 0.25);
            border-color: rgba(16, 185, 129, 0.5);
            transform: scale(1.08);
            box-shadow: 0 3px 8px rgba(16, 185, 129, 0.3);
        }

        body.dark-mode .payment-badge-cod {
            background: rgba(245, 158, 11, 0.2);
            border-color: rgba(245, 158, 11, 0.4);
        }

        body.dark-mode .payment-badge-card {
            background: rgba(16, 185, 129, 0.2);
            border-color: rgba(16, 185, 129, 0.4);
        }

        body.dark-mode .payment-badge-cod:hover {
            background: rgba(245, 158, 11, 0.3);
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
        }

        body.dark-mode .payment-badge-card:hover {
            background: rgba(16, 185, 129, 0.3);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        /* Ensure pagination is always visible */
        .pagination-container {
            position: relative;
            z-index: 10;
            flex-shrink: 0;
            /* Prevent pagination from being squished */
            min-height: 60px;
            /* Fixed height to prevent layout shift */
        }

        th {
            text-align: left;
            padding: 0.75rem 1rem;
            /* Reduced padding */
            color: var(--text-muted);
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-bottom: 1px solid var(--border-light);
            position: sticky;
            top: 0;
            background: var(--bg-dark);
            /* Ensure header is readable */
            z-index: 10;
            backdrop-filter: blur(12px);
            /* Glassmorphism for header */
        }

        /* Fix for glassmorphism background on sticky header */
        th::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--bg-panel);
            opacity: 0.9;
            z-index: -1;
        }

        td {
            padding: 0.5rem 1rem;
            /* Reduced padding */
            border-bottom: 1px solid var(--border-light);
            color: var(--text-main);
            font-size: 0.875rem;
            vertical-align: middle;
        }

        tr:last-child td {
            border-bottom: none;
        }

        tr:hover td {
            background: rgba(255, 255, 255, 0.02);
        }

        .status-badge {
            padding: 0.25rem 0.6rem;
            /* Compact badge */
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
        }

        .status-badge::before {
            content: '';
            width: 6px;
            height: 6px;
            border-radius: 50%;
        }

        .status-completed {
            background: rgba(16, 185, 129, 0.1);
            color: #10b981;
            border: 1px solid rgba(16, 185, 129, 0.2);
        }

        .status-completed::before {
            background: #10b981;
        }

        .status-pending {
            background: rgba(245, 158, 11, 0.1);
            color: #f59e0b;
            border: 1px solid rgba(245, 158, 11, 0.2);
        }

        .status-pending::before {
            background: #f59e0b;
        }

        .status-processing {
            background: rgba(59, 130, 246, 0.1);
            color: #3b82f6;
            border: 1px solid rgba(59, 130, 246, 0.2);
        }

        .status-processing::before {
            background: #3b82f6;
        }

        .status-cancelled {
            background: rgba(244, 63, 94, 0.1);
            color: #f43f5e;
            border: 1px solid rgba(244, 63, 94, 0.2);
        }

        .status-cancelled::before {
            background: #f43f5e;
        }

        /* Delivery Widget */
        .delivery-widget {
            margin: 1rem 0 1.5rem;
            padding: 1rem;
            border-radius: 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-light);
            transition: all 0.3s ease;
        }

        .sidebar.collapsed .delivery-widget {
            display: none;
        }

        .widget-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .widget-title {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .time-selector {
            position: relative;
        }

        .time-trigger {
            display: flex;
            align-items: center;
            gap: 0.25rem;
            font-size: 0.75rem;
            color: var(--text-muted);
            cursor: pointer;
            padding: 4px 8px;
            border-radius: 8px;
            transition: all 0.2s ease;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-light);
        }

        .time-trigger:hover {
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-main);
        }

        .time-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 0.5rem;
            background: var(--bg-card);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid var(--border-light);
            border-radius: 12px;
            padding: 0.5rem;
            min-width: 100px;
            display: none;
            flex-direction: column;
            gap: 0.25rem;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            z-index: 100;
            opacity: 0;
            transform: translateY(-10px);
            transition: all 0.2s ease;
        }

        .time-dropdown.show {
            display: flex;
            opacity: 1;
            transform: translateY(0);
        }

        .time-option {
            padding: 0.5rem 0.75rem;
            font-size: 0.75rem;
            color: var(--text-muted);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .time-option:hover {
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-main);
        }

        .time-option.active {
            background: rgba(6, 182, 212, 0.1);
            color: var(--primary);
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.75rem;
        }

        .stat-row:last-child {
            margin-bottom: 0;
        }

        .stat-label {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.85rem;
            color: var(--text-dim);
        }

        .stat-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .dot-delivery {
            background: #3b82f6;
            box-shadow: 0 0 8px rgba(59, 130, 246, 0.4);
        }

        .dot-delivered {
            background: #10b981;
            box-shadow: 0 0 8px rgba(16, 185, 129, 0.4);
        }

        .dot-returned {
            background: #ef4444;
            box-shadow: 0 0 8px rgba(239, 68, 68, 0.4);
        }

        .stat-value-sm {
            font-weight: 600;
            font-size: 0.9rem;
            color: var(--text-main);
            font-family: 'Outfit', sans-serif;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-dark);
        }

        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        /* Pagination */
        .pagination {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 1.5rem;
            border-top: 1px solid var(--border-light);
        }

        .pagination-info {
            color: var(--text-muted);
            font-size: 0.875rem;
        }

        .pagination-controls {
            display: flex;
            gap: 0.5rem;
        }

        .page-btn {
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            border: 1px solid var(--border-light);
            background: transparent;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.875rem;
        }

        .page-btn:hover:not(.disabled):not(:disabled) {
            background: rgba(0, 0, 0, 0.05);
            color: var(--text-main);
        }

        .page-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .page-btn.disabled,
        .page-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            pointer-events: none;
        }

        body.dark-mode .page-btn:hover:not(.disabled):not(:disabled) {
            background: rgba(255, 255, 255, 0.1);
        }

        /* Document Badges */
        .doc-group {
            display: flex;
            gap: 0.5rem;
        }

        .doc-badge {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            border: 1px solid transparent;
        }

        .doc-badge:hover {
            transform: translateY(-2px);
        }

        .doc-invoice {
            background: rgba(59, 130, 246, 0.1);
            color: #3b82f6;
            border-color: rgba(59, 130, 246, 0.2);
        }

        .doc-invoice:hover {
            background: rgba(59, 130, 246, 0.2);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.2);
        }

        .doc-shipping {
            background: rgba(139, 92, 246, 0.1);
            color: #8b5cf6;
            border-color: rgba(139, 92, 246, 0.2);
        }

        .doc-shipping:hover {
            background: rgba(139, 92, 246, 0.2);
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.2);
        }

        /* Tooltip */
        .doc-badge::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%) translateY(-5px);
            background: var(--bg-dark);
            color: var(--text-main);
            padding: 0.25rem 0.5rem;
            border-radius: 6px;
            font-size: 0.75rem;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: all 0.2s ease;
            pointer-events: none;
            border: 1px solid var(--border-light);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            z-index: 10;
        }

        .doc-badge:hover::after {
            opacity: 1;
            visibility: visible;
            transform: translateX(-50%) translateY(-8px);
        }

        /* Custom Premium Tooltip */
        .custom-tooltip {
            position: fixed;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(0, 0, 0, 0.1);
            box-shadow: 0 20px 40px -5px rgba(0, 0, 0, 0.1), 0 0 15px rgba(6, 182, 212, 0.1);
            border-radius: 16px;
            padding: 1.25rem;
            pointer-events: none;
            opacity: 0;
            visibility: hidden;
            transform: translateY(10px) scale(0.95);
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            max-width: 320px;
            color: var(--text-main);
        }

        body.dark-mode .custom-tooltip {
            background: rgba(17, 24, 39, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 20px 40px -5px rgba(0, 0, 0, 0.4), 0 0 15px rgba(6, 182, 212, 0.1);
        }

        .custom-tooltip.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0) scale(1);
        }

        .tooltip-header {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--text-muted);
            margin-bottom: 0.75rem;
            font-weight: 600;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
            padding-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        body.dark-mode .tooltip-header {
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .tooltip-content {
            font-size: 0.9rem;
            line-height: 1.5;
        }

        .tooltip-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.75rem;
        }

        .tooltip-item:last-child {
            margin-bottom: 0;
        }

        .tooltip-item-icon {
            width: 32px;
            height: 32px;
            background: rgba(0, 0, 0, 0.05);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
            flex-shrink: 0;
        }

        body.dark-mode .tooltip-item-icon {
            background: rgba(255, 255, 255, 0.05);
        }

        .tooltip-item-details {
            flex: 1;
        }

        .tooltip-item-name {
            font-weight: 500;
            color: var(--text-main);
        }

        .tooltip-item-meta {
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        /* Bulk Actions Dropdown */
        .bulk-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            width: 260px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(0, 0, 0, 0.1);
            box-shadow: 0 20px 40px -5px rgba(0, 0, 0, 0.1), 0 0 15px rgba(6, 182, 212, 0.1);
            border-radius: 16px;
            padding: 0.5rem;
            margin-top: 0.5rem;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 100;
            overflow: hidden;
        }

        body.dark-mode .bulk-dropdown {
            background: rgba(17, 24, 39, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 20px 40px -5px rgba(0, 0, 0, 0.4), 0 0 15px rgba(6, 182, 212, 0.1);
        }

        .bulk-dropdown.show {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }

        .bulk-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            color: var(--text-main);
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            border-radius: 10px;
            transition: all 0.2s ease;
            opacity: 0;
            transform: translateX(-10px);
        }

        .bulk-dropdown.show .bulk-item {
            opacity: 1;
            transform: translateX(0);
        }

        .bulk-item:hover {
            background: rgba(6, 182, 212, 0.1);
            color: var(--primary);
            padding-left: 1.25rem;
            /* Slide effect on hover */
        }

        .bulk-item i {
            width: 16px;
            height: 16px;
            transition: transform 0.2s ease;
        }

        .bulk-item:hover i {
            transform: scale(1.1);
        }

        /* Staggered Animation Delays */
        .bulk-dropdown.show .bulk-item:nth-child(1) {
            transition-delay: 0.05s;
        }

        .bulk-dropdown.show .bulk-item:nth-child(2) {
            transition-delay: 0.1s;
        }

        .bulk-dropdown.show .bulk-item:nth-child(3) {
            transition-delay: 0.15s;
        }

        .bulk-dropdown.show .bulk-item:nth-child(4) {
            transition-delay: 0.2s;
        }

        .bulk-dropdown.show .bulk-item:nth-child(5) {
            transition-delay: 0.25s;
        }

        .bulk-dropdown.show .bulk-item:nth-child(6) {
            transition-delay: 0.3s;
        }

        .bulk-dropdown.show .bulk-item:nth-child(7) {
            transition-delay: 0.35s;
        }

        .bulk-dropdown.show .bulk-item:nth-child(8) {
            transition-delay: 0.4s;
        }

        .bulk-dropdown.show .bulk-item:nth-child(9) {
            transition-delay: 0.45s;
        }

        .bulk-dropdown.show .bulk-item:nth-child(10) {
            transition-delay: 0.5s;
        }

        .bulk-dropdown.show .bulk-item:nth-child(11) {
            transition-delay: 0.55s;
        }

        .bulk-dropdown.show .bulk-item:nth-child(12) {
            transition-delay: 0.6s;
        }

        /* Timeline Styles for Status Tooltip */
        .timeline {
            position: relative;
            padding-left: 1.5rem;
            margin-top: 0.5rem;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 6px;
            top: 4px;
            bottom: 4px;
            width: 2px;
            background: rgba(0, 0, 0, 0.1);
            border-radius: 2px;
        }

        body.dark-mode .timeline::before {
            background: rgba(255, 255, 255, 0.1);
        }

        .timeline-item {
            position: relative;
            margin-bottom: 1.25rem;
            opacity: 0;
            transform: translateX(-10px);
            animation: slideInRight 0.3s ease forwards;
        }

        .timeline-item:last-child {
            margin-bottom: 0;
        }

        .timeline-dot {
            position: absolute;
            left: -1.5rem;
            top: 4px;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            background: var(--bg-panel);
            border: 2px solid var(--text-muted);
            z-index: 1;
            transition: all 0.3s ease;
        }

        .timeline-item.completed .timeline-dot {
            background: var(--primary);
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(6, 182, 212, 0.2);
        }

        .timeline-item.current .timeline-dot {
            background: var(--primary);
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(6, 182, 212, 0.4);
            animation: pulse 2s infinite;
        }

        .timeline-content {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
        }

        .timeline-title {
            font-weight: 600;
            font-size: 0.85rem;
            color: var(--text-main);
        }

        .timeline-date {
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        @keyframes slideInRight {
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes pulse {
            0% {
                box-shadow: 0 0 0 0 rgba(6, 182, 212, 0.4);
            }

            70% {
                box-shadow: 0 0 0 6px rgba(6, 182, 212, 0);
            }

            100% {
                box-shadow: 0 0 0 0 rgba(6, 182, 212, 0);
            }
        }
    </style>
</head>

<body>

    <!-- Sidebar -->
    <aside class="sidebar glass" id="sidebar">
        <div class="sidebar-toggle" id="sidebarToggle">
            <i data-feather="chevron-left" style="width: 14px; height: 14px;"></i>
        </div>

        <div class="logo-container">
            <div class="app-brand">
                <div class="logo-icon">
                    <i data-feather="box" style="width: 18px; height: 18px;"></i>
                </div>
                <span class="logo-text">NEXUS</span>
            </div>

            <div class="workspace-selector" id="workspaceSelector">
                <div class="workspace-icon">N</div>
                <div class="workspace-info">
                    <div class="workspace-name">NEXUS Store</div>
                    <div class="workspace-role">
                        <span>Admin</span>
                        <div style="width: 4px; height: 4px; border-radius: 50%; background: var(--text-muted);"></div>
                        <span style="color: var(--primary);">Pro</span>
                    </div>
                </div>
                <i data-feather="chevron-down" class="selector-chevron"
                    style="width: 16px; height: 16px; color: var(--text-muted);"></i>
            </div>

            <div class="workspace-dropdown" id="workspaceDropdown">
                <div class="workspace-search">
                    <i data-feather="search"></i>
                    <input type="text" id="workspaceSearch" placeholder="Find workspace...">
                </div>
                <div class="workspace-list" id="workspaceList">
                    <!-- Populated by JS -->
                </div>
                <div class="workspace-actions">
                    <button class="create-workspace-btn">
                        <i data-feather="plus" style="width: 14px; height: 14px;"></i>
                        <span>Create New Workspace</span>
                    </button>
                </div>
            </div>
        </div>

        <nav class="nav-menu">
            <a href="#" class="nav-item" data-page="dashboard">
                <i data-feather="grid"></i>
                <span>Dashboard</span>
            </a>
            <a href="#" class="nav-item active" data-page="orders">
                <i data-feather="shopping-cart"></i>
                <span>Orders</span>
            </a>
            <a href="#" class="nav-item" data-page="customers">
                <i data-feather="users"></i>
                <span>Customers</span>
            </a>
            <a href="#" class="nav-item" data-page="inventory">
                <i data-feather="package"></i>
                <span>Inventory</span>
            </a>
            <a href="#" class="nav-item" data-page="analytics">
                <i data-feather="bar-chart-2"></i>
                <span>Analytics</span>
            </a>
            <a href="#" class="nav-item" data-page="settings">
                <i data-feather="settings"></i>
                <span>Settings</span>
            </a>
        </nav>

        <!-- Delivery Status Widget -->
        <div class="delivery-widget glass-card">
            <div class="widget-header">
                <span class="widget-title">Delivery Status</span>
                <div class="time-selector">
                    <div class="time-trigger" id="timeTrigger">
                        <span id="currentTime">7d</span>
                        <i data-feather="chevron-down" style="width: 12px; height: 12px;"></i>
                    </div>
                    <div class="time-dropdown" id="timeDropdown">
                        <div class="time-option" data-period="24h">Last 24 Hours</div>
                        <div class="time-option active" data-period="7d">Last 7 Days</div>
                        <div class="time-option" data-period="30d">Last 30 Days</div>
                    </div>
                </div>
            </div>
            <div class="widget-content">
                <div class="stat-row">
                    <div class="stat-label">
                        <div class="stat-dot dot-delivery"></div>
                        <span>In Delivery</span>
                    </div>
                    <span class="stat-value-sm" data-stat="in-delivery">67</span>
                </div>
                <div class="stat-row">
                    <div class="stat-label">
                        <div class="stat-dot dot-delivered"></div>
                        <span>Delivered</span>
                    </div>
                    <span class="stat-value-sm" data-stat="delivered">30</span>
                </div>
                <div class="stat-row">
                    <div class="stat-label">
                        <div class="stat-dot dot-returned"></div>
                        <span>Returned</span>
                    </div>
                    <span class="stat-value-sm" data-stat="returned">0</span>
                </div>
            </div>
        </div>

        <div class="user-profile" id="userProfile">
            <div class="profile-dropdown" id="profileDropdown">
                <a href="#" class="profile-menu-item">
                    <i data-feather="user"></i>
                    <span>My Profile</span>
                </a>
                <a href="#" class="profile-menu-item">
                    <i data-feather="settings"></i>
                    <span>Settings</span>
                </a>
                <a href="#" class="profile-menu-item">
                    <i data-feather="help-circle"></i>
                    <span>Help Center</span>
                </a>
                <div class="profile-menu-item logout">
                    <i data-feather="log-out"></i>
                    <span>Logout</span>
                </div>
            </div>
            <div class="avatar"></div>
            <div class="user-info">
                <h4>Alex Morgan</h4>
                <p>Admin</p>
            </div>
            <i data-feather="chevron-right" class="profile-chevron"
                style="margin-left: auto; color: var(--text-muted); width: 16px; transition: transform 0.3s ease;"></i>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Header -->
        <header class="header glass">
            <div class="search-bar">
                <i data-feather="search" class="search-icon"></i>
                <input type="text" placeholder="Search orders, products, or customers...">
            </div>

            <div class="header-actions">
                <div class="icon-btn">
                    <i data-feather="bell"></i>
                    <span class="notification-dot"></span>
                </div>
                <div class="icon-btn">
                    <i data-feather="mail"></i>
                </div>
                <div class="icon-btn" id="themeToggle">
                    <i data-feather="sun"></i>
                </div>
            </div>
        </header>

        <!-- Dashboard Content -->
        <div class="dashboard-container">

            <div class="page-header">
                <div class="page-title">
                    <h1>Orders Management</h1>
                    <p>Manage and track all customer orders.</p>
                </div>
                <div style="display: flex; gap: 1rem;">
                    <button class="icon-btn" style="width: 40px; height: 40px;" title="Refresh">
                        <i data-feather="refresh-cw" style="width: 16px;"></i>
                    </button>
                    <button class="icon-btn" style="width: auto; padding: 0 1rem; gap: 0.5rem;">
                        <i data-feather="download" style="width: 16px;"></i>
                        Export
                    </button>
                    <div class="bulk-actions-container" style="position: relative;">
                        <button class="action-btn" id="bulkActionsBtn" style="padding-right: 1rem;">
                            <i data-feather="layers"></i>
                            Bulk Actions
                            <i data-feather="chevron-down" class="bulk-chevron"
                                style="width: 14px; margin-left: 0.25rem; transition: transform 0.3s ease;"></i>
                        </button>
                        <div class="bulk-dropdown" id="bulkDropdown">
                            <div class="bulk-item"><i data-feather="download-cloud"></i> Import New Orders</div>
                            <div class="bulk-item"><i data-feather="upload"></i> Export Selected</div>
                            <div class="bulk-item"><i data-feather="package"></i> Packing List</div>
                            <div class="bulk-item" style="color: var(--accent);"><i data-feather="trash-2"></i> Delete
                                Selected</div>
                            <div class="bulk-item"><i data-feather="tag"></i> Create Labels</div>
                            <div class="bulk-item"><i data-feather="share"></i> Export Labels</div>
                            <div class="bulk-item"><i data-feather="send"></i> Send Labels</div>
                            <div class="bulk-item"><i data-feather="map-pin"></i> Update Tracking</div>
                            <div class="bulk-item"><i data-feather="check-circle"></i> Fulfill Orders</div>
                            <div class="bulk-item"><i data-feather="shopping-bag"></i> Sync Shopify</div>
                            <div class="bulk-item"><i data-feather="file-text"></i> Create Invoices</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Orders Table -->
            <div class="glass-card table-container">
                <div class="table-header">
                    <div style="display: flex; gap: 1rem; align-items: center;">
                        <h3 class="chart-title">All Orders</h3>
                        <span id="totalOrdersCount"
                            style="background: rgba(6, 182, 212, 0.1); color: var(--primary); padding: 0.25rem 0.75rem; border-radius: 20px; font-size: 0.75rem; font-weight: 600;">0
                            Total</span>
                    </div>
                    <div class="header-actions">
                        <div class="filter-dropdown-container" style="position: relative;">
                            <button class="action-btn" id="filterBtn"
                                style="background: var(--bg-card); border: 1px solid var(--border-light); color: var(--text-muted); padding: 0.5rem 1rem; min-width: 160px; justify-content: space-between;">
                                <span style="display: flex; align-items: center; gap: 0.5rem;">
                                    <i data-feather="filter" style="width: 14px;"></i>
                                    <span id="currentFilterLabel">Status: All</span>
                                </span>
                                <i data-feather="chevron-down" class="filter-chevron"
                                    style="width: 14px; transition: transform 0.3s ease;"></i>
                            </button>
                            <div class="bulk-dropdown" id="filterDropdown" style="width: 100%; min-width: 160px;">
                                <div class="bulk-item" onclick="filterOrders('All')">All Statuses</div>
                                <div class="bulk-item" onclick="filterOrders('Completed')"><span
                                        class="status-badge status-completed"
                                        style="padding: 2px 6px; font-size: 0.65rem;">Completed</span></div>
                                <div class="bulk-item" onclick="filterOrders('Processing')"><span
                                        class="status-badge status-processing"
                                        style="padding: 2px 6px; font-size: 0.65rem;">Processing</span></div>
                                <div class="bulk-item" onclick="filterOrders('Pending')"><span
                                        class="status-badge status-pending"
                                        style="padding: 2px 6px; font-size: 0.65rem;">Pending</span></div>
                                <div class="bulk-item" onclick="filterOrders('Cancelled')"><span
                                        class="status-badge status-cancelled"
                                        style="padding: 2px 6px; font-size: 0.65rem;">Cancelled</span></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="table-wrapper">
                    <table>
                        <thead>
                            <tr>
                                <th style="width: 40px;"><input type="checkbox" style="cursor: pointer;"></th>
                                <th style="width: 140px;">Order ID</th>
                                <th style="width: 180px;">Customer</th>
                                <th style="width: 180px;">Address</th>
                                <th style="width: 200px;">Products</th>
                                <th style="width: 110px;">Amount</th>
                                <th style="width: 120px;">Status</th>
                                <th style="width: 100px;">Documents</th>
                                <th style="width: 100px;">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="ordersTableBody">
                            <!-- Rows will be generated by JS -->
                        </tbody>
                    </table>
                </div>
                <!-- Pagination -->
                <div class="pagination-container"
                    style="display: flex; justify-content: space-between; align-items: center; padding: 1rem 1.5rem; border-top: 1px solid var(--border-light); background: var(--bg-panel); backdrop-filter: blur(12px);">
                    <div id="paginationInfo" style="font-size: 0.875rem; color: var(--text-muted);">
                        Showing <span style="font-weight: 600; color: var(--text-main);">1-50</span> of <span
                            style="font-weight: 600; color: var(--text-main);">0</span> orders
                    </div>
                    <div id="paginationControls" style="display: flex !important; gap: 0.5rem; align-items: center;">
                        <!-- Pagination buttons will be generated dynamically -->
                    </div>
                </div>
            </div>

        </div>
    </main>

    <!-- Custom Tooltip Container -->
    <div id="customTooltip" class="custom-tooltip"></div>

    <script>
        // Real Data Variables
        let currentWorkspaceId = null;
        let allWorkspaces = [];
        let allOrders = [];
        let currentPage = 1;
        let totalPages = 1;
        let totalOrders = 0;
        let currentFilter = 'All';

        // Load workspaces on page load
        async function loadWorkspaces() {
            try {
                const response = await fetch('/api/workspaces');
                const data = await response.json();
                allWorkspaces = data.workspaces;
                
                const urlParams = new URLSearchParams(window.location.search);
                const workspaceParam = urlParams.get('workspace');
                
                if (allWorkspaces.length > 0) {
                    if (workspaceParam) {
                        const workspaceId = parseInt(workspaceParam);
                        const workspaceExists = allWorkspaces.find(w => w.workspace_id === workspaceId);
                        if (workspaceExists) {
                            currentWorkspaceId = workspaceId;
                        } else {
                            currentWorkspaceId = allWorkspaces[0].workspace_id;
                        }
                    } else {
                        currentWorkspaceId = allWorkspaces[0].workspace_id;
                    }
                }
                
                // Update sidebar UI
                updateWorkspaceSidebarUI();
            } catch (error) {
                console.error('Failed to load workspaces:', error);
            }
        }

        // Load real orders from API
        async function loadOrders(page = 1) {
            try {
                const response = await fetch(`/api/imported-orders?page=${page}&limit=50&workspaceId=${currentWorkspaceId}`);
                const result = await response.json();
                
                if (result.success) {
                    allOrders = result.orders;
                    currentPage = result.pagination.currentPage;
                    totalPages = result.pagination.totalPages;
                    totalOrders = result.pagination.totalOrders;
                    
                    console.log(` Loaded ${allOrders.length} orders for workspace ${currentWorkspaceId}`);
                    debugOrderStatuses(); // Debug status breakdown
                    
                    renderOrders(currentFilter);
                    updatePaginationControls(); // Update pagination UI
                } else {
                    console.error('Failed to load orders:', result.error);
                }
            } catch (error) {
                console.error('Error loading orders:', error);
            }
        }

        // Get order status from API data
        function getOrderStatus(order) {
            // Check if delivered
            if (order.deliveryStatus === 'delivered' || order.deliveryStatus === '' || order.deliveredAt) {
                return 'Completed';
            }
            
            // Check if has voucher (fulfilled/in transit)
            if (order.voucherNumber) {
                return 'Processing';
            }
            
            // Otherwise it's pending (not yet fulfilled)
            return 'Pending';
        }

        // Debug: Log order statuses (you can remove this after testing)
        function debugOrderStatuses() {
            console.log(' Order Status Breakdown:');
            const statusCounts = { Completed: 0, Processing: 0, Pending: 0 };
            allOrders.forEach(order => {
                const status = getOrderStatus(order);
                statusCounts[status]++;
                if (statusCounts[status] <= 3) { // Log first 3 of each type
                    console.log(`  ${status}: ${order.orderName} (voucher: ${order.voucherNumber || 'none'}, delivered: ${order.deliveryStatus || 'none'})`);
                }
            });
            console.log('Total:', statusCounts);
        }

        // Generate order history timeline
        function generateOrderHistory(order) {
            const history = [];
            const formatDate = (date) => {
                if (!date) return 'N/A';
                return new Date(date).toLocaleDateString('en-US', { month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' });
            };

            history.push({ 
                title: "Order Placed", 
                date: formatDate(order.importedAt || order.processed), 
                completed: true 
            });

            if (order.financialStatus === 'paid') {
                history.push({ 
                    title: "Payment Confirmed", 
                    date: formatDate(order.processed), 
                    completed: true 
                });
            } else {
                history.push({ 
                    title: "Payment Pending", 
                    date: "Awaiting payment", 
                    completed: false, 
                    current: !order.voucherNumber 
                });
            }

            if (order.voucherNumber) {
                history.push({ 
                    title: "Voucher Created", 
                    date: formatDate(order.voucherCreatedAt), 
                    completed: true 
                });
                
                if (order.deliveryStatus === 'delivered' || order.deliveryStatus === '') {
                    history.push({ 
                        title: "In Transit", 
                        date: formatDate(order.deliveryStatusUpdatedAt), 
                        completed: true 
                    });
                    history.push({ 
                        title: "Delivered", 
                        date: formatDate(order.deliveredAt), 
                        completed: true, 
                        current: true 
                    });
                } else if (order.deliveryStatus) {
                    history.push({ 
                        title: order.deliveryStatus, 
                        date: formatDate(order.deliveryStatusUpdatedAt) || "In progress", 
                        completed: false, 
                        current: true 
                    });
                } else {
                    history.push({ 
                        title: "In Transit", 
                        date: "Tracking...", 
                        completed: false, 
                        current: true 
                    });
                }
            }

            return history;
        }

        function renderOrders(filterStatus = 'All') {
            let html = '';
            
            let filteredOrders = allOrders;
            if (filterStatus !== 'All') {
                filteredOrders = allOrders.filter(order => {
                    const status = getOrderStatus(order);
                    return status === filterStatus;
                });
            }

            filteredOrders.forEach((order, index) => {
                const status = getOrderStatus(order);
                const statusClass = `status-${status.toLowerCase()}`;
                
                const customerName = `${order.firstName || ''} ${order.lastName || ''}`.trim() || 'Unknown';
                const customerEmail = order.email || 'No email';
                
                const fullAddress = `${order.address1 || ''}, ${order.city || ''}, ${order.zip || ''}`.replace(/, ,/g, ',').trim();
                
                const products = order.products || [];
                const hasProducts = products.length > 0;
                const mainProduct = hasProducts ? products[0] : { name: 'No products', quantity: 0 };
                const mainProductQuantity = mainProduct.quantity || 1;
                const additionalItems = products.length > 1 ? products.length - 1 : 0;
                
                // Calculate total items for display
                const totalItems = products.reduce((sum, p) => sum + (p.quantity || 1), 0);
                
                const productsJson = JSON.stringify(products.map(p => ({
                    name: p.name || p.title,
                    price: parseFloat(p.price) || 0,
                    quantity: p.quantity || 1,
                    icon: 'package',
                    type: 'Product'
                }))).replace(/"/g, '&quot;');
                
                const history = generateOrderHistory(order);
                const historyJson = JSON.stringify(history).replace(/"/g, '&quot;');
                
                let docsHtml = '';
                const hasInvoice = order.oblioInvoiceNumber;
                const hasVoucher = order.voucherNumber;
                
                if (hasInvoice) {
                    docsHtml += `
                        <div class="doc-badge doc-invoice" data-tooltip="Invoice: ${order.oblioSeriesName}-${order.oblioInvoiceNumber}" onclick="window.open('${order.oblioInvoiceUrl}', '_blank')" style="cursor: pointer;">
                            <i data-feather="file-text" style="width: 14px; height: 14px;"></i>
                        </div>`;
                } else {
                    docsHtml += `
                        <div class="doc-badge doc-invoice" data-tooltip="No Invoice" style="opacity: 0.5; cursor: not-allowed;">
                            <i data-feather="file-text" style="width: 14px; height: 14px;"></i>
                        </div>`;
                }
                
                if (hasVoucher) {
                    docsHtml += `
                        <div class="doc-badge doc-shipping" data-tooltip="Voucher: ${order.voucherNumber}">
                            <i data-feather="truck" style="width: 14px; height: 14px;"></i>
                        </div>`;
                } else {
                    docsHtml += `
                        <div class="doc-badge doc-shipping" data-tooltip="No Voucher" style="opacity: 0.5; cursor: not-allowed;">
                            <i data-feather="truck" style="width: 14px; height: 14px;"></i>
                        </div>`;
                }

                html += `
                    <tr>
                        <td><input type="checkbox" style="cursor: pointer;"></td>
                        <td style="font-family: 'Outfit', sans-serif; font-weight: 600;">${order.orderName}</td>
                        <td>
                            <div>
                                <div style="font-weight: 500; font-size: 0.875rem;">${customerName}</div>
                                <div style="font-size: 0.7rem; color: var(--text-muted);">${customerEmail}</div>
                            </div>
                        </td>
                        <td class="hover-trigger" data-tooltip-type="address" data-tooltip-content="${fullAddress}" style="max-width: 180px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; color: var(--text-muted); font-size: 0.8rem; cursor: help;">
                            ${fullAddress || 'No address'}
                        </td>
                        <td class="hover-trigger" data-tooltip-type="products" data-tooltip-content="${productsJson}" style="cursor: help;">
                            <div style="display: flex; flex-direction: column;">
                                <span style="font-size: 0.875rem;">${mainProductQuantity}x ${mainProduct.name || mainProduct.title || 'No products'}</span>
                                ${additionalItems > 0 ? `<span style="font-size: 0.7rem; color: var(--text-muted);">+ ${totalItems - mainProductQuantity} items</span>` : ''}
                            </div>
                        </td>
                        <td>
                            <div style="display: flex; align-items: center;">
                                <span style="font-weight: 600;">${parseFloat(order.totalPrice || 0).toFixed(2)}</span>
                                ${order.paymentStatus === 'cod' ? `
                                    <div class="payment-badge payment-badge-cod" data-tooltip="Cash on Delivery">
                                        <i data-feather="dollar-sign"></i>
                                    </div>
                                ` : `
                                    <div class="payment-badge payment-badge-card" data-tooltip="Paid by Card">
                                        <i data-feather="credit-card"></i>
                                    </div>
                                `}
                            </div>
                        </td>
                        <td class="hover-trigger" data-tooltip-type="status" data-tooltip-content="${historyJson}" style="cursor: help;">
                            <span class="status-badge ${statusClass}">${status}</span>
                        </td>
                        <td>
                            <div class="doc-group">
                                ${docsHtml}
                            </div>
                        </td>
                        <td>
                            <div style="display: flex; gap: 0.5rem;">
                                <div class="icon-btn" style="width: 28px; height: 28px;" title="View Order"><i data-feather="eye" style="width: 14px;"></i></div>
                                <div class="icon-btn" style="width: 28px; height: 28px;" title="Track Order"><i data-feather="map-pin" style="width: 14px;"></i></div>
                            </div>
                        </td>
                    </tr>
                `;
            });

            const ordersTableBody = document.getElementById('ordersTableBody');
            ordersTableBody.innerHTML = html || '<tr><td colspan="9" style="text-align: center; padding: 2rem; color: var(--text-muted);">No orders found</td></tr>';
            feather.replace();
            attachTooltipListeners();
        }

        // Update pagination controls
        function updatePaginationControls() {
            if (totalOrders === 0) return; // Don't show pagination if no orders
            
            const start = (currentPage - 1) * 50 + 1;
            const end = Math.min(currentPage * 50, totalOrders);
            
            // Update total count in header
            document.getElementById('totalOrdersCount').textContent = `${totalOrders.toLocaleString()} Total`;
            
            // Update pagination info
            document.getElementById('paginationInfo').innerHTML = `
                Showing <span style="font-weight: 600; color: var(--text-main);">${start}-${end}</span> of 
                <span style="font-weight: 600; color: var(--text-main);">${totalOrders.toLocaleString()}</span> orders
            `;
            
            // Generate page buttons
            const paginationControls = document.getElementById('paginationControls');
            let html = '';
            
            console.log(' Generating pagination:', { currentPage, totalPages, totalOrders });
            
            // Previous button
            html += `
                <button class="page-btn ${currentPage === 1 ? 'disabled' : ''}" 
                        onclick="changePage(${currentPage - 1})"
                        ${currentPage === 1 ? 'disabled' : ''}>
                    <i data-feather="chevron-left" style="width: 16px;"></i>
                </button>
            `;
            
            // Page numbers logic
            let startPage = Math.max(1, currentPage - 1);
            let endPage = Math.min(totalPages, startPage + 2);
            
            // Adjust if we're near the end
            if (endPage - startPage < 2) {
                startPage = Math.max(1, endPage - 2);
            }
            
            // First page
            if (startPage > 1) {
                html += `<button class="page-btn" onclick="changePage(1)">1</button>`;
                if (startPage > 2) {
                    html += `<span style="display: flex; align-items: center; color: var(--text-muted);">...</span>`;
                }
            }
            
            // Page numbers
            for (let i = startPage; i <= endPage; i++) {
                html += `
                    <button class="page-btn ${i === currentPage ? 'active' : ''}" 
                            onclick="changePage(${i})">${i}</button>
                `;
            }
            
            // Last page
            if (endPage < totalPages) {
                if (endPage < totalPages - 1) {
                    html += `<span style="display: flex; align-items: center; color: var(--text-muted);">...</span>`;
                }
                html += `<button class="page-btn" onclick="changePage(${totalPages})">${totalPages}</button>`;
            }
            
            // Next button
            html += `
                <button class="page-btn ${currentPage === totalPages ? 'disabled' : ''}" 
                        onclick="changePage(${currentPage + 1})"
                        ${currentPage === totalPages ? 'disabled' : ''}>
                    <i data-feather="chevron-right" style="width: 16px;"></i>
                </button>
            `;
            
            paginationControls.innerHTML = html;
            console.log(' Pagination HTML updated, buttons:', paginationControls.children.length);
            feather.replace();
        }

        // Change page
        async function changePage(page) {
            if (page < 1 || page > totalPages || page === currentPage) return;
            
            // Add subtle loading state
            const tableBody = document.getElementById('ordersTableBody');
            tableBody.style.opacity = '0.5';
            tableBody.style.transition = 'opacity 0.15s ease';
            
            await loadOrders(page);
            
            // Restore opacity
            setTimeout(() => {
                tableBody.style.opacity = '1';
            }, 50);
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Filter Logic
        const filterBtn = document.getElementById('filterBtn');
        const filterDropdown = document.getElementById('filterDropdown');
        const filterChevron = filterBtn.querySelector('.filter-chevron');
        const currentFilterLabel = document.getElementById('currentFilterLabel');

        filterBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            filterDropdown.classList.toggle('show');
            filterChevron.style.transform = filterDropdown.classList.contains('show') ? 'rotate(180deg)' : 'rotate(0deg)';
        });

        function filterOrders(status) {
            currentFilter = status;
            renderOrders(status);
            currentFilterLabel.textContent = status === 'All' ? 'Status: All' : `Status: ${status}`;
            filterDropdown.classList.remove('show');
            filterChevron.style.transform = 'rotate(0deg)';
        }

        // Close dropdowns on outside click
        document.addEventListener('click', (e) => {
            if (!filterBtn.contains(e.target) && !filterDropdown.contains(e.target)) {
                filterDropdown.classList.remove('show');
                if (filterChevron) filterChevron.style.transform = 'rotate(0deg)';
            }
        });

        // Initialize app
        async function initApp() {
            await loadWorkspaces();
            await loadOrders();
            
            // Load theme preference
            if (localStorage.getItem('darkMode') === 'true') {
                document.body.classList.add('dark-mode');
                document.getElementById('themeToggle').innerHTML = '<i data-feather="moon" style="width: 20px; height: 20px;"></i>';
            }
            
            // Check for collapsed sidebar
            if (localStorage.getItem('sidebarCollapsed') === 'true') {
                document.getElementById('sidebar').classList.add('collapsed');
                document.getElementById('sidebarToggle').innerHTML = '<i data-feather="chevron-right" style="width: 14px; height: 14px;"></i>';
            }
            
            feather.replace();
        }

        initApp();

        // Custom Tooltip Logic
        const tooltip = document.getElementById('customTooltip');

        function attachTooltipListeners() {
            document.querySelectorAll('.hover-trigger').forEach(el => {
                el.addEventListener('mouseenter', (e) => {
                    const type = el.getAttribute('data-tooltip-type');
                    const content = el.getAttribute('data-tooltip-content');

                    if (type === 'address') {
                        tooltip.innerHTML = `
                            <div class="tooltip-header">
                                <i data-feather="map-pin" style="width: 14px;"></i>
                                Shipping Address
                            </div>
                            <div class="tooltip-content" style="font-size: 0.95rem; color: var(--text-main);">
                                ${content}
                            </div>
                        `;
                    } else if (type === 'products') {
                        const products = JSON.parse(content.replace(/&quot;/g, '"'));
                        let itemsHtml = '';

                        products.forEach(prod => {
                            itemsHtml += `
                                <div class="tooltip-item">
                                    <div class="tooltip-item-icon">
                                        <i data-feather="${prod.icon}" style="width: 16px;"></i>
                                    </div>
                                    <div class="tooltip-item-details">
                                        <div class="tooltip-item-name">${prod.quantity}x ${prod.name}</div>
                                        <div class="tooltip-item-meta">${prod.type}  ${prod.price.toFixed(2)} each</div>
                                    </div>
                                </div>
                            `;
                        });

                        tooltip.innerHTML = `
                            <div class="tooltip-header">
                                <i data-feather="package" style="width: 14px;"></i>
                                Order Contents
                            </div>
                            <div class="tooltip-content">
                                ${itemsHtml}
                            </div>
                        `;
                    } else if (type === 'status') {
                        const history = JSON.parse(content.replace(/&quot;/g, '"'));
                        let timelineHtml = '<div class="timeline">';

                        history.forEach((event, index) => {
                            const completedClass = event.completed ? 'completed' : '';
                            const currentClass = event.current ? 'current' : '';
                            const delay = index * 0.1;

                            timelineHtml += `
                                <div class="timeline-item ${completedClass} ${currentClass}" style="animation-delay: ${delay}s">
                                    <div class="timeline-dot"></div>
                                    <div class="timeline-content">
                                        <div class="timeline-title">${event.title}</div>
                                        <div class="timeline-date">${event.date}</div>
                                    </div>
                                </div>
                            `;
                        });

                        timelineHtml += '</div>';

                        tooltip.innerHTML = `
                            <div class="tooltip-header">
                                <i data-feather="activity" style="width: 14px;"></i>
                                Order History
                            </div>
                            <div class="tooltip-content">
                                ${timelineHtml}
                            </div>
                        `;
                    }

                    feather.replace();
                    tooltip.classList.add('show');
                    updateTooltipPosition(e);
                });

                el.addEventListener('mousemove', updateTooltipPosition);

                el.addEventListener('mouseleave', () => {
                    tooltip.classList.remove('show');
                });
            });
        }

        function updateTooltipPosition(e) {
            const x = e.clientX;
            const y = e.clientY;

            // Check bounds to prevent overflow
            const tooltipRect = tooltip.getBoundingClientRect();
            const winWidth = window.innerWidth;
            const winHeight = window.innerHeight;

            let left = x + 15;
            let top = y + 15;

            if (left + tooltipRect.width > winWidth) {
                left = x - tooltipRect.width - 15;
            }

            if (top + tooltipRect.height > winHeight) {
                top = y - tooltipRect.height - 15;
            }

            tooltip.style.left = `${left}px`;
            tooltip.style.top = `${top}px`;
        }

        // Sidebar Toggle Logic
        const sidebar = document.getElementById('sidebar');
        const sidebarToggle = document.getElementById('sidebarToggle');

        sidebarToggle.addEventListener('click', () => {
            sidebar.classList.toggle('collapsed');
            const collapsed = sidebar.classList.contains('collapsed');

            localStorage.setItem('sidebarCollapsed', collapsed);

            if (collapsed) {
                sidebarToggle.innerHTML = '<i data-feather="chevron-right" style="width: 14px; height: 14px;"></i>';
            } else {
                sidebarToggle.innerHTML = '<i data-feather="chevron-left" style="width: 14px; height: 14px;"></i>';
            }
            feather.replace();
        });

        // Workspace Switcher Logic
        const workspaceSelector = document.getElementById('workspaceSelector');
        const workspaceDropdown = document.getElementById('workspaceDropdown');
        const selectorChevron = workspaceSelector.querySelector('.selector-chevron');

        workspaceSelector.addEventListener('click', (e) => {
            e.stopPropagation();
            workspaceDropdown.classList.toggle('show');
            selectorChevron.style.transform = workspaceDropdown.classList.contains('show') ? 'rotate(180deg)' : 'rotate(0deg)';
        });

        document.addEventListener('click', (e) => {
            if (!workspaceSelector.contains(e.target) && !workspaceDropdown.contains(e.target)) {
                workspaceDropdown.classList.remove('show');
                selectorChevron.style.transform = 'rotate(0deg)';
            }
        });

        // Theme Switcher Logic
        const themeToggle = document.getElementById('themeToggle');
        const body = document.body;

        themeToggle.addEventListener('click', () => {
            // Add transitioning class for performance optimization
            body.classList.add('transitioning');
            
            // Toggle dark mode
            body.classList.toggle('dark-mode');
            const isDark = body.classList.contains('dark-mode');

            // Save preference
            localStorage.setItem('darkMode', isDark);

            // Update icon
            if (isDark) {
                themeToggle.innerHTML = '<i data-feather="moon" style="width: 20px; height: 20px;"></i>';
            } else {
                themeToggle.innerHTML = '<i data-feather="sun" style="width: 20px; height: 20px;"></i>';
            }

            // Replace icons
            feather.replace();
            
            // Remove transitioning class after transition completes
            setTimeout(() => {
                body.classList.remove('transitioning');
            }, 300);
        });

        // Simple interactivity for nav items
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', function (e) {
                // Only prevent default if it's a dummy link
                if (this.getAttribute('href') === '#') {
                    e.preventDefault();
                }
                // Don't remove active class from other items here, let the page load handle it
                // or only do it for visual feedback if staying on same page
            });
        });

        // Bulk Actions Logic
        const bulkActionsBtn = document.getElementById('bulkActionsBtn');
        const bulkDropdown = document.getElementById('bulkDropdown');
        const bulkChevron = bulkActionsBtn.querySelector('.bulk-chevron');

        bulkActionsBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            bulkDropdown.classList.toggle('show');
            bulkChevron.style.transform = bulkDropdown.classList.contains('show') ? 'rotate(180deg)' : 'rotate(0deg)';
        });

        document.addEventListener('click', (e) => {
            if (!bulkActionsBtn.contains(e.target) && !bulkDropdown.contains(e.target)) {
                bulkDropdown.classList.remove('show');
                if (bulkChevron) bulkChevron.style.transform = 'rotate(0deg)';
            }
        });

        // Helper function to render workspace dropdown list
        function renderWorkspaceDropdownList() {
            const workspaceList = document.getElementById('workspaceList');
            if (!workspaceList) return;

            const workspaceSearch = document.getElementById('workspaceSearch');
            const filter = workspaceSearch?.value.toLowerCase() || '';
            const filtered = allWorkspaces.filter(w => 
                w.workspace_name.toLowerCase().includes(filter)
            );

            workspaceList.innerHTML = filtered.map(w => {
                const icon = w.workspace_name.charAt(0).toUpperCase();
                const isActive = w.workspace_id === currentWorkspaceId;
                return `
                    <div class="workspace-item ${isActive ? 'active' : ''}" onclick="window.location.href='/orders.html?workspace=${w.workspace_id}'">
                        <div class="item-icon">${icon}</div>
                        <div style="flex: 1;">
                            <div style="font-size: 0.875rem; font-weight: 600; color: var(--text-main);">${w.workspace_name}</div>
                            <div style="font-size: 0.75rem; color: var(--text-muted);">${w.workspace_slug || 'workspace'}.nexus.com</div>
                        </div>
                        ${isActive ? '<i data-feather="check" style="width: 16px; color: var(--primary);"></i>' : ''}
                    </div>
                `;
            }).join('');

            feather.replace();
        }

        // Helper function to update workspace UI in sidebar
        function updateWorkspaceSidebarUI() {
            if (allWorkspaces.length > 0 && currentWorkspaceId) {
                const workspace = allWorkspaces.find(w => w.workspace_id === currentWorkspaceId);
                if (workspace) {
                    const icon = workspace.workspace_name.charAt(0).toUpperCase();
                    const workspaceIconEl = document.querySelector('.workspace-icon');
                    const workspaceNameEl = document.querySelector('.workspace-name');
                    if (workspaceIconEl) workspaceIconEl.textContent = icon;
                    if (workspaceNameEl) workspaceNameEl.textContent = workspace.workspace_name;
                    renderWorkspaceDropdownList();
                }
            }
        }

        // Delivery Widget Logic
        const deliveryStats = {
            '24h': { 'in-delivery': 12, 'delivered': 8, 'returned': 0 },
            '7d': { 'in-delivery': 67, 'delivered': 30, 'returned': 2 },
            '30d': { 'in-delivery': 245, 'delivered': 180, 'returned': 15 }
        };

        const timeTrigger = document.getElementById('timeTrigger');
        const timeDropdown = document.getElementById('timeDropdown');
        const currentTime = document.getElementById('currentTime');
        const timeOptions = document.querySelectorAll('.time-option');
        const statValues = document.querySelectorAll('.stat-value-sm');
        const triggerIcon = timeTrigger.querySelector('i');

        // Toggle Dropdown
        timeTrigger.addEventListener('click', (e) => {
            e.stopPropagation();
            timeDropdown.classList.toggle('show');
            triggerIcon.style.transform = timeDropdown.classList.contains('show') ? 'rotate(180deg)' : 'rotate(0deg)';
        });

        // Handle Option Click
        timeOptions.forEach(option => {
            option.addEventListener('click', (e) => {
                e.stopPropagation();

                // Update active state
                timeOptions.forEach(opt => opt.classList.remove('active'));
                option.classList.add('active');

                // Update Trigger Text (short version)
                const period = option.dataset.period;
                currentTime.textContent = period;

                // Update stats with animation
                const data = deliveryStats[period];
                statValues.forEach(stat => {
                    const key = stat.dataset.stat;
                    const target = data[key];
                    animateValue(stat, parseInt(stat.textContent), target, 500);
                });

                // Close Dropdown
                timeDropdown.classList.remove('show');
                triggerIcon.style.transform = 'rotate(0deg)';
            });
        });

        // Close on Outside Click
        document.addEventListener('click', (e) => {
            if (!timeTrigger.contains(e.target) && !timeDropdown.contains(e.target)) {
                timeDropdown.classList.remove('show');
                if (triggerIcon) triggerIcon.style.transform = 'rotate(0deg)';
            }
        });

        function animateValue(obj, start, end, duration) {
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                obj.innerHTML = Math.floor(progress * (end - start) + start);
                if (progress < 1) {
                    window.requestAnimationFrame(step);
                }
            };
            window.requestAnimationFrame(step);
        }


        // Profile Dropdown Logic
        const userProfile = document.getElementById('userProfile');
        const profileDropdown = document.getElementById('profileDropdown');
        const profileChevron = userProfile.querySelector('.profile-chevron');

        userProfile.addEventListener('click', (e) => {
            e.stopPropagation();
            const isExpanded = profileDropdown.classList.contains('show');

            // Close other dropdowns if any (optional, good practice)
            document.querySelectorAll('.dropdown.show').forEach(d => d.classList.remove('show'));

            if (isExpanded) {
                profileDropdown.classList.remove('show');
                if (profileChevron) profileChevron.style.transform = 'rotate(0deg)';
            } else {
                profileDropdown.classList.add('show');
                if (profileChevron) profileChevron.style.transform = 'rotate(-90deg)';
            }
        });

        document.addEventListener('click', (e) => {
            if (!userProfile.contains(e.target)) {
                profileDropdown.classList.remove('show');
                if (profileChevron) profileChevron.style.transform = 'rotate(0deg)';
            }
        });
    </script>
</body>

</html>
